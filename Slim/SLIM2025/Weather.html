<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portsalon Weather</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React + ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide-react/dist/umd/lucide-react.js"></script>
  </head>
  <body class="bg-sky-50">
    <div id="root"></div>

    <script type="text/javascript">
      const { useState, useEffect } = React;
      const { Cloud, CloudRain, CloudSunRain } = lucideReact;

      function WeatherWidget() {
        const [forecast, setForecast] = useState([]);
        const [lastUpdate, setLastUpdate] = useState(null);

        useEffect(() => {
          async function getForecast() {
            const lat = 55.2;
            const lon = -7.6;

            const res = await fetch(
              `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,precipitation,weathercode&timezone=auto&start_date=2025-09-04&end_date=2025-09-07`
            );
            const data = await res.json();

            if (!data.hourly) return;

            const hours = data.hourly.time.map((t, i) => ({
              time: t,
              temp: data.hourly.temperature_2m[i],
              rain: data.hourly.precipitation[i],
              code: data.hourly.weathercode[i],
            }));

            const filtered = hours.filter((h) => {
              const d = new Date(h.time);
              return d.getHours() >= 7 && d.getHours() <= 19;
            });

            setForecast(filtered);
            setLastUpdate(new Date().toLocaleString());
          }

          getForecast();
          const interval = setInterval(getForecast, 10 * 60 * 1000);
          return () => clearInterval(interval);
        }, []);

        function getIcon(code, rain) {
          if (rain > 0) return React.createElement(CloudRain);
          if (code === 0) return React.c
