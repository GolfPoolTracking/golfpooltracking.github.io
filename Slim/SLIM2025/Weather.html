<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weather Forecast</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f0f4f8;
    }
    h1 {
      text-align: center;
      color: #2a4d69;
    }
    #forecast {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .card {
      background: white;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
    }
    .time {
      font-weight: bold;
      margin-bottom: 10px;
      color: #2a4d69;
    }
    .temp {
      font-size: 1.5em;
      margin: 5px 0;
    }
    .icon {
      font-size: 2em;
      margin: 5px 0;
    }
    .wind {
      margin: 5px 0;
    }
    .rain {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <h1>Weather Forecast (26 Aug, 12–18)</h1>
  <div id="forecast">Loading forecast...</div>

  <script>
    // Map Met Éireann symbol numbers to simple emojis/icons
    const weatherIcons = {
      "1": "☀️", // clear
      "2": "🌤️", // partly cloudy
      "3": "☁️", // cloudy
      "4": "🌧️", // showers
      "5": "🌦️", // rain
      "6": "⛈️", // thunder
      "7": "❄️", // snow
      "8": "🌫️", // fog
    };

    // Convert wind direction (deg) to arrow
    function windArrow(deg) {
      if (!deg) return "❓";
      const dirs = ["↑ N","↗ NE","→ E","↘ SE","↓ S","↙ SW","← W","↖ NW"];
      return dirs[Math.round(deg / 45) % 8];
    }

    async function loadForecast() {
      try {
        const res = await fetch("forecast_data/forecast.json");
        if (!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();

        if (!data || data.length === 0) {
          document.getElementById("forecast").innerHTML = "<p>No forecast available yet.</p>";
          return;
        }

        document.getElementById("forecast").innerHTML = data.map(entry => {
          const dt = new Date(entry.time);
          const hour = dt.toLocaleTimeString([], {hour: "2-digit", minute: "2-digit"});
          const temp = entry.Temperature ? `${entry.Temperature} °C` : "N/A";
          const rain = entry.Rainfall ? `${entry.Rainfall} mm` : "0 mm";
          const ws = entry.WindSpeed ? (parseFloat(entry.WindSpeed) * 3.6).toFixed(1) + " km/h" : "0 km/h";
          const wd = entry.WindDirection ? windArrow(parseFloat(entry.WindDirection)) : "N/A";
          const icon = weatherIcons[entry.WeatherSymbol3] || "❓";

          return `
            <div class="card">
              <div class="time">${hour}</div>
              <div class="icon">${icon}</div>
              <div class="temp">${temp}</div>
              <div class="wind">💨 ${ws} ${wd}</div>
              <div class="rain">🌧️ ${rain}</div>
            </div>
          `;
        }).join("");

      } catch (err) {
        console.error("Error loading forecast:", err);
        document.getElementById("forecast").innerHTML = "<p>Error loading forecast.</p>";
      }
    }

    loadForecast();
  </script>
</body>
</html>
